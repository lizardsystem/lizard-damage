{% extends 'lizard_ui/lizardbase.html' %}
{% load formatting %}

{% block sidebar %}
<div>
  Info scenario
  <dl>
    <dt>Naam</dt>
    <dd>{{ view.damage_scenario.name }}</dd>

    <dt>Aangemaakt op</dt>
    <dd>{{ view.damage_scenario.datetime_created }}</dd>

    <dt>Status</dt>
    <dd>{{ view.damage_scenario.display_status }}</dd>

    <dt>Aantal gebeurtenissen</dt>
    <dd>{{ view.damage_scenario.damageevent_set.count }}</dd>
  </dl>
  <div>
    <a href="{% url lizard_damage_form %}">Ga naar beginscherm</a>
  </div>
  <div>
    {{ view.version }}
  </div>
</div>
{% endblock %}

{% block content %}
<div class="textual-content">
<h2>Resultaten berekening {{ view.damage_scenario }}</h2>

{% for event in view.damage_scenario.damageevent_set.all %}
<h3>Gebeurtenis {{ event }}</h3>
<div>
<a href="https://maps.google.com/maps?q={{ view.root_url }}{% url lizard_damage_event_kml slug=event.slug %}" target="_blank" alt="bekijken in Google Maps">bekijken</a>&nbsp;<a href="{{ event.result.url }}" alt="{{ event.result_display }}">downloaden</a>{% if user.is_authenticated %}&nbsp;<a href="{% url lizard_damage_event_kml slug=event.slug %}">kml</a>{% endif %}

<dl>
  <dt>Waterstand</dt>
  <dd>{{ event.waterlevel }}</dd>

  <dt>Schadetabel</dt>
  <dd>{% firstof view.damage_scenario.damagetable 'standaard' %}</dd>

  <dt>Duur overlast</dt>
  <dd>{{ event.floodtime|hoursformat }}</dd>

  <dt>Hersteltijd wegen</dt>
  <dd>{{ event.repairtime_roads|daysformat }}</dd>

  <dt>Hersteltijd bebouwing</dt>
  <dd>{{ event.repairtime_buildings|daysformat }}</dd>

  <dt>Maand gebeurtenis</dt>
  <dd>{{ event.floodmonth|monthformat }}</dd>
</dl>

{% with event.parsed_table as event_table %}
<table class="table table-striped">
  <thead>
    <th>Categorie</th>
    <th>Oppervlakte met schade</th>
    <th>Schade</th>
  </thead>
  <tbody>
    {% for data_row in event_table.1 %}
    <tr>
      <td title="{{ data_row.description }} ({{ data_row.source }} - {{ data_row.code }})">
      {{ data_row.description }}
      </td>
      <td title="{{ data_row.area_ha|floatformat }}">
      {% autoescape off %}{{ data_row.area_ha|haformat }}{% endautoescape %}
      </td>
      <td title="{{ data_row.damage|floatformat }}">
      {% autoescape off %}{{ data_row.damage|euroformat }}{% endautoescape %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endwith %}

{% empty %}
Er zijn geen gebeurtenissen verbonden aan deze resultaten (dat mag nooit gebeuren). Contacteer systeembeheerder.
{% endfor %}
</div>
</div>
{% endblock %}
